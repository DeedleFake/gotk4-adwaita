// Code generated by girgen. DO NOT EDIT.

package adw

import (
	"runtime"
	"unsafe"

	"github.com/diamondburned/gotk4/pkg/core/gbox"
	externglib "github.com/diamondburned/gotk4/pkg/core/glib"
)

// #cgo pkg-config: libadwaita-1
// #cgo CFLAGS: -Wno-deprecated-declarations
// #include <stdlib.h>
// #include <adwaita.h>
// #include <glib-object.h>
// extern void callbackDelete(gpointer);
// void _gotk4_adw1_AnimationTargetFunc(double, gpointer);
import "C"

func init() {
	externglib.RegisterGValueMarshalers([]externglib.TypeMarshaler{
		{T: externglib.Type(C.adw_animation_target_get_type()), F: marshalAnimationTargetter},
		{T: externglib.Type(C.adw_callback_animation_target_get_type()), F: marshalCallbackAnimationTargetter},
	})
}

// AnimationTargetFunc: prototype for animation targets based on user callbacks.
type AnimationTargetFunc func(value float64)

//export _gotk4_adw1_AnimationTargetFunc
func _gotk4_adw1_AnimationTargetFunc(arg0 C.double, arg1 C.gpointer) {
	v := gbox.Get(uintptr(arg1))
	if v == nil {
		panic(`callback not found`)
	}

	var value float64 // out

	value = float64(arg0)

	fn := v.(AnimationTargetFunc)
	fn(value)
}

// AnimationTarget represents a value animation can animate.
//
// Currently the only implementation is callbackanimationtarget.
type AnimationTarget struct {
	*externglib.Object
}

var (
	_ externglib.Objector = (*AnimationTarget)(nil)
)

// AnimationTargetter describes types inherited from class AnimationTarget.

// To get the original type, the caller must assert this to an interface or
// another type.
type AnimationTargetter interface {
	externglib.Objector
	baseAnimationTarget() *AnimationTarget
}

var _ AnimationTargetter = (*AnimationTarget)(nil)

func wrapAnimationTarget(obj *externglib.Object) *AnimationTarget {
	return &AnimationTarget{
		Object: obj,
	}
}

func marshalAnimationTargetter(p uintptr) (interface{}, error) {
	return wrapAnimationTarget(externglib.ValueFromNative(unsafe.Pointer(p)).Object()), nil
}

func (v *AnimationTarget) baseAnimationTarget() *AnimationTarget {
	return v
}

// BaseAnimationTarget returns the underlying base object.
func BaseAnimationTarget(obj AnimationTargetter) *AnimationTarget {
	return obj.baseAnimationTarget()
}

// CallbackAnimationTarget: animationtarget that calls a given callback during
// the animation.
type CallbackAnimationTarget struct {
	AnimationTarget
}

var (
	_ AnimationTargetter = (*CallbackAnimationTarget)(nil)
)

func wrapCallbackAnimationTarget(obj *externglib.Object) *CallbackAnimationTarget {
	return &CallbackAnimationTarget{
		AnimationTarget: AnimationTarget{
			Object: obj,
		},
	}
}

func marshalCallbackAnimationTargetter(p uintptr) (interface{}, error) {
	return wrapCallbackAnimationTarget(externglib.ValueFromNative(unsafe.Pointer(p)).Object()), nil
}

// NewCallbackAnimationTarget creates a new AdwAnimationTarget that calls the
// given callback during the animation.
//
// The function takes the following parameters:
//
//    - callback to call.
//
func NewCallbackAnimationTarget(callback AnimationTargetFunc) *CallbackAnimationTarget {
	var _arg1 C.AdwAnimationTargetFunc // out
	var _arg2 C.gpointer
	var _arg3 C.GDestroyNotify
	var _cret *C.AdwAnimationTarget // in

	if callback != nil {
		_arg1 = (*[0]byte)(C._gotk4_adw1_AnimationTargetFunc)
		_arg2 = C.gpointer(gbox.Assign(callback))
		_arg3 = (C.GDestroyNotify)((*[0]byte)(C.callbackDelete))
	}

	_cret = C.adw_callback_animation_target_new(_arg1, _arg2, _arg3)
	runtime.KeepAlive(callback)

	var _callbackAnimationTarget *CallbackAnimationTarget // out

	_callbackAnimationTarget = wrapCallbackAnimationTarget(externglib.AssumeOwnership(unsafe.Pointer(_cret)))

	return _callbackAnimationTarget
}
